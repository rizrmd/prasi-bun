{"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAsBA,MAAM,6BAAO;IACX,KAAK,EAAE;IACP,QAAQ,CAAC;IACT,OAAO,EAAE;AACX;AAEA,MAAM,0BAAI;AAIH,MAAM,4CAAc;IACzB,MAAM,IAAI,CAAA,GAAA,gBAAQ,EAAE,CAAA,GAAA,mBAAW,GAAG;IAClC,MAAM,QAAQ,CAAA,GAAA,eAAO,EAAE;QACrB,MAAM;YACJ,WAAW;YACX,MAAM;QACR;QACA,YAAY;QACZ,cAAc;QACd,SAAS;QACT,WAAW;YAAE,UAAU;YAAI,MAAM;QAAG;QACpC,WAAW;QACX,MAAM;QACN,WAAW;QACX,cAAc;IAChB;IAEA,CAAA,GAAA,gBAAQ,EAAE;QACR,MAAM,IAAI,CAAC;YACT,IACE,EAAE,GAAG,KAAK,YACV,SAAS,aAAa,EAAE,QAAQ,kBAAkB,SAClD;gBACA,wBAAE,iBAAiB,GAAG;gBACtB,MAAM,MAAM;YACd;YACA,IACE,MAAM,SAAS,IACf,CAAC,MAAM,IAAI,CAAC,IAAI,IAChB,SAAS,aAAa,EAAE,QAAQ,kBAAkB,SAClD;gBACA,wBAAE,iBAAiB,GAAG;gBACtB,MAAM,MAAM;gBACZ,MAAM,SAAS,CAAC,KAAK;YACvB;QACF;QACA,OAAO,gBAAgB,CAAC,WAAW;QACnC,OAAO;YACL,OAAO,mBAAmB,CAAC,WAAW;QACxC;IACF,GAAG,EAAE;IAEL,MAAM,cAAc;QAClB,IAAI,MAAM,OAAO,EAAE,OAAO;QAC1B,MAAM,OAAO,GAAG;QAChB,MAAM,MAAM;QAEZ,MAAM,UAAU,MAAM,GAAG,WAAW,CAAC,QAAQ,CAAC;YAC5C,OAAO;gBACL,SAAS,EAAE,IAAI,CAAC,EAAE;gBAClB,YAAY;YACd;QACF;QACA,IAAI,SAAS;YACX,2BAAK,MAAM,GAAG,CAAC;YAEf,KAAK,MAAM,KAAK,QACd,2BAAK,MAAM,CAAC,EAAE,EAAE,CAAC,GAAG;gBAAE,GAAG,CAAC;YAAC;YAG7B,2BAAK,GAAG,GAAG,MAAM,GAAG,IAAI,CAAC,QAAQ,CAAC;gBAChC,OAAO;oBACL,SAAS,EAAE,IAAI,CAAC,EAAE;oBAClB,YAAY;gBACd;gBACA,QAAQ;oBACN,IAAI;oBACJ,MAAM;oBACN,KAAK;oBACL,SAAS;oBACT,mBAAmB;oBACnB,WAAW;gBACb;YACF;QACF;QACA,MAAM,OAAO,GAAG;QAChB,MAAM,MAAM;IACd;IACA,IAAI,CAAC,MAAM,OAAO,CAAC,2BAAK,GAAG,GACzB,2BAAK,GAAG,GAAG,EAAE;IAGf,IAAI,2BAAK,GAAG,CAAC,MAAM,KAAK,GACtB;IAGF,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,OAAO,EAAE;QACjC,2BAAK,KAAK,GAAG;YACX;gBACE,IAAI;gBACJ,QAAQ;gBACR,MAAM;gBACN,WAAW;YACb;SACD;QACD,MAAM,UAAU,IAAI;QAEpB,KAAK,MAAM,QAAQ,2BAAK,GAAG,CAAE;YAC3B,MAAM,MAAM,KAAK,SAAS,IAAI;YAC9B,MAAM,SAAS,2BAAK,MAAM,CAAC,IAAI;YAE/B,IACE,wBAAE,iBAAiB,IACnB,CAAC,AAAC,CAAA,KAAK,IAAI,GAAG,KAAK,GAAG,AAAD,EAClB,WAAW,GACX,QAAQ,CAAC,wBAAE,iBAAiB,CAAC,WAAW,KAE3C;YAGF,IAAI,SAAS,QAAQ,MAAM;YAC3B,IAAI,wBAAE,iBAAiB,EAAE,SAAS;YAElC,2BAAK,KAAK,CAAC,IAAI,CAAC;gBACd,IAAI,KAAK,EAAE;wBACX;gBACA,MAAM,KAAK,IAAI;gBACf,MAAM;oBAAE,SAAS,CAAC;oBAAG,GAAG,IAAI;gBAAC;gBAC7B,WAAW;YACb;QACF;QAEA,IAAI,CAAC,wBAAE,iBAAiB,EAAE;YACxB,KAAK,MAAM,UAAU,OAAO,MAAM,CAAC,2BAAK,MAAM,EAC5C,IAAI,CAAC,QAAQ,GAAG,CAAC,OAAO,EAAE,GAAG;gBAC3B,QAAQ,GAAG,CAAC,OAAO,EAAE;gBACrB,2BAAK,KAAK,CAAC,IAAI,CAAC;oBACd,IAAI,OAAO,EAAE;oBACb,QAAQ,OAAO,SAAS,IAAI;oBAC5B,MAAM,OAAO,IAAI,IAAI;oBACrB,MAAM;wBAAE,SAAS,CAAC;oBAAE;oBACpB,WAAW;gBACb;YACF;QAEJ;QAEA,IAAI,MAAM,SAAS,CAAC,QAAQ,EAC1B,2BAAK,KAAK,CAAC,IAAI,CAAC;YACd,IAAI;YACJ,QAAQ,MAAM,SAAS,CAAC,QAAQ;YAChC,MAAM;YACN,WAAW;QACb;IAEJ;IAEA,MAAM,cAAc,aAAa,OAAO,CAAC;IACzC,IAAI,WAAW;QAAC;KAAO;IACvB,IAAI,aACF,WAAW,KAAK,KAAK,CAAC;IAGxB,qBACE;;0BACE,gBAAC;gBACC,WAAU;gBACV,SAAS;oBACP,EAAE,OAAO,CAAC,IAAI,GAAG;oBACjB,EAAE,MAAM;gBACV;;0BAEF,iBAAC;gBAAI,WAAU;;oBACZ,MAAM,OAAO,iBACZ,gBAAC;wBAAI,WAAU;kCACb,cAAA,gBAAC,CAAA,GAAA,cAAM;4BAAE,MAAK;4BAAW,UAAU;;uCAGrC,iBAAC;wBACC,KAAK,CAAC;4BACJ,MAAM,SAAS,GAAG;wBACpB;wBACA,WAAW,GACT,6CACA,GAAG,CAAC;;;;;;;;;;;;;;;;;;;cAmBJ,CAAC;;0CAGH,gBAAC;gCAAI,WAAU;0CACb,cAAA,gBAAC;oCACC,MAAK;oCACL,OAAO,wBAAE,iBAAiB,IAAI;oCAC9B,UAAU,CAAC;wCACT,wBAAE,iBAAiB,GAAG,EAAE,aAAa,CAAC,KAAK;wCAC3C,MAAM,MAAM;oCACd;oCACA,KAAK,CAAC;wCACJ,MAAM,SAAS,GAAG;oCACpB;oCACA,aAAY;oCACZ,WAAU;;;0CAGd,gBAAC,CAAA,GAAA,kBAAU;gCAAE,SAAS,CAAA,GAAA,mBAAW;gCAAG,SAAS,CAAA,GAAA,wBAAgB;0CAC3D,cAAA,gBAAC,CAAA,GAAA,WAAG;oCACF,MAAM,2BAAK,KAAK;oCAChB,mBAAmB,kBAAM;oCACzB,QAAO;oCACP,QAAQ,OAAO,SAAgC;wCAC7C,MAAM,IAAI,GAAG;wCACb,2BAAK,KAAK,GAAG;wCACb,MAAM,MAAM;wCAEZ,IAAI,CAAC,IAAI,UAAU,EAAE,WACnB,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;4CACnB,OAAO;gDACL,IAAI,IAAI,YAAY;4CACtB;4CACA,MAAM;gDACJ,WAAY,IAAI,YAAY,KAAK,UACjC,CAAC,IAAI,YAAY,GACb,OACA,IAAI,YAAY;4CACtB;4CACA,QAAQ;gDAAE,IAAI;4CAAK;wCACrB;6CAEA,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC;4CAC1B,OAAO;gDACL,IAAI,IAAI,YAAY;4CACtB;4CACA,MAAM;gDACJ,WAAY,IAAI,YAAY,KAAK,UACjC,CAAC,IAAI,YAAY,GACb,OACA,IAAI,YAAY;4CACtB;4CACA,QAAQ;gDACN,IAAI;4CACN;wCACF;wCAEF;oCACF;oCACA,aAAa;oCACb,SAAS;wCACP,UAAU;wCACV,YAAY;oCACd;oCACA,cAAc,CAAC;wCACb,aAAa,OAAO,CAClB,qBACA,KAAK,SAAS,CAAC;oCAEnB;oCACA,QAAQ,CAAC,MAAM,SAAE,KAAK,UAAE,MAAM,YAAE,QAAQ,YAAE,QAAQ,EAAE,iBAClD,iBAAC;4CACC,KAAK,CAAC;gDACJ,IACE,MACA,CAAC,MAAM,YAAY,IACnB,OAAO,OAAO,KAAK,KAAK,IAAI,EAAE,IAC9B;oDACA,MAAM,YAAY,GAAG;oDACrB,GAAG,cAAc,CAAC;wDAChB,UAAU;wDACV,OAAO;oDACT;gDACF;4CACF;4CACA,WAAW,GACT,4DACA,kDACA,OAAO,OAAO,KAAK,KAAK,IAAI,EAAE,MAC5B,oDACF,GAAG,CAAC;;;;;;;;sBAQJ,CAAC;4CAEH,OAAO;gDAAE,mBAAmB,QAAQ;4CAAG;4CACvC,SAAS;gDACP,IAAI,KAAK,SAAS,EAChB;qDACK;oDACL,MAAM,OAAO,KAAK,IAAI;oDACtB,IAAI,QAAQ,KAAK,EAAE,EAAE;wDACnB,EAAE,OAAO,CAAC,IAAI,GAAG;wDACjB,SAAS,CAAC,QAAQ,EAAE,KAAK,OAAO,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;oDAC/C;gDACF;4CACF;;8DAEA,iBAAC;oDAAI,WAAU;;wDACZ,KAAK,SAAS,kBACb;;gEACG,wBAAU,gBAAC;gEACX,CAAC,wBAAU,gBAAC;;;wDAGhB,CAAC,KAAK,SAAS,kBAAI,gBAAC;;;gDAEtB,MAAM,YAAY,KAAK,KAAK,EAAE,iBAC7B,gBAAC;oDACC,MAAK;oDACL,OAAO,MAAM,SAAS,CAAC,IAAI,IAAI;oDAC/B,SAAS;oDACT,SAAS,CAAC;wDACR,EAAE,eAAe;oDACnB;oDACA,WAAU;oDACV,QAAQ;wDACN,MAAM,YAAY,GAAG;wDACrB,IAAI,MAAM,SAAS,CAAC,QAAQ,EAC1B;4DAAA,IAAI,MAAM,SAAS,CAAC,IAAI,EAAE;gEACxB,MAAM,YAAY,2BAAK,GAAG,CAAC,EAAE;gEAE7B,MAAM,OAAO,GAAG;gEAChB,MAAM,MAAM;gEACZ,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC;oEAC1B,MAAM;wEACJ,SAAS,UAAU,OAAO;wEAC1B,MAAM,MAAM,SAAS,CAAC,IAAI;wEAC1B,WACE,MAAM,SAAS,CAAC,QAAQ,KAAK,UAC7B,CAAC,MAAM,SAAS,CAAC,QAAQ,GACrB,OACA,MAAM,SAAS,CAAC,QAAQ;oEAChC;gEACF;gEAEA,MAAM,OAAO,GAAG;gEAChB,MAAM;gEACN,MAAM,OAAO,GAAG;gEAChB,MAAM,IAAI,GAAG;gEACb,MAAM,MAAM;4DACd;wDAAA,OACK;4DACL,KAAK,IAAI,GAAG,MAAM,SAAS,CAAC,IAAI;4DAChC,MAAM,OAAO,GAAG;4DAChB,MAAM,MAAM;4DACZ,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC;gEAC1B,MAAM;oEACJ,MAAM,MAAM,SAAS,CAAC,IAAI;gEAC5B;gEACA,OAAO;oEACL,IAAI,KAAK,EAAE;gEACb;gEACA,QAAQ;oEAAE,IAAI;gEAAK;4DACrB;4DACA,MAAM,OAAO,GAAG;4DAChB,MAAM;4DACN,MAAM,IAAI,GAAG;4DACb,MAAM,MAAM;wDACd;wDAEA,MAAM,SAAS,CAAC,IAAI,GAAG;wDACvB,MAAM,SAAS,CAAC,QAAQ,GAAG;wDAC3B,MAAM,MAAM;oDACd;oDACA,SAAS,CAAC;wDACR,EAAE,aAAa,CAAC,MAAM;oDACxB;oDACA,WAAW,CAAC;wDACV,IAAI,EAAE,GAAG,KAAK,SAAS,EAAE,aAAa,CAAC,IAAI;oDAC7C;oDACA,UAAU,CAAC;wDACT,MAAM,SAAS,CAAC,IAAI,GAAG,EAAE,aAAa,CAAC,KAAK;wDAC5C,MAAM,MAAM;oDACd;mEAGF,iBAAC;oDAAI,WAAU;;sEACb,gBAAC;4DAAI,WAAU;sEACZ,KAAK,IAAI,CAAC,UAAU,CAAC,2BACpB;;kFACE,gBAAC;wEAAI,WAAU;kFAAgD;;kFAG/D,gBAAC;kFAAK,KAAK,IAAI,CAAC,SAAS,CAAC;;;iEAG5B,KAAK,IAAI;;sEAGb,iBAAC;4DACC,WAAW,GACT;;gEAGD,KAAK,EAAE,KAAK,wBACX,gBAAC;oEACC,SAAS,CAAC;wEACR,EAAE,eAAe;wEAEjB,IAAI,KAAK,SAAS,EAAE;4EAClB,MAAM,IAAI,GAAG;4EACb,MAAM,YAAY,GAAG,KAAK,EAAE;4EAC5B,MAAM,MAAM;wEACd,OAAO;4EACL,MAAM,IAAI,CAAC,IAAI,GAAG,KAAK,IAAI;4EAC3B,MAAM,MAAM;wEACd;oEACF;oEACA,WAAU;8EAEV,cAAA,gBAAC;;gEAGJ,KAAK,SAAS,kBACb;;sFACE,gBAAC;4EACC,SAAS,CAAC;gFACR,EAAE,eAAe;gFACjB,IAAI,CAAC,QACH;gFAGF,MAAM,IAAI,GAAG;gFACb,MAAM,YAAY,GAAG;gFACrB,MAAM,SAAS,CAAC,QAAQ,GAAG,KAAK,EAAE;gFAClC,MAAM,MAAM;4EACd;4EACA,WAAU;sFAEV,cAAA,gBAAC;0FAAK;;;sFAGR,gBAAC;4EACC,SAAS,CAAC;gFACR,EAAE,eAAe;gFACjB,IAAI,CAAC,QACH;gFAGF,MAAM,IAAI,GAAG;gFACb,MAAM,IAAI,CAAC,IAAI,GAAG;oFAChB,SAAS,EAAE,IAAI,CAAC,EAAE;oFAClB,WAAW,KAAK,EAAE;gFACpB;gFACA,MAAM,IAAI,CAAC,SAAS,GAAG,KAAK,EAAE;gFAC9B,MAAM,MAAM;4EACd;4EACA,WAAU;sFAEV,cAAA,gBAAC;0FAAK;;;;;gEAKX,CAAC,KAAK,SAAS,kBACd,gBAAC;oEACC,SAAS,OAAO;wEACd,EAAE,eAAe;wEACjB,IAAI,QAAQ,iBAAiB;4EAC3B,MAAM,OAAO,GAAG;4EAChB,MAAM,MAAM;4EACZ,MAAM,OAAQ,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC;gFACpC,OAAO;oFAAE,IAAI,KAAK,EAAE;gFAAW;4EACjC;4EAEA,OAAO,KAAK,EAAE;4EACd,KAAK,IAAI,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,SAAS,CAAC;4EACnC,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,GAAG,CAAC,OAAO,CAAC;4EAC/B,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gFACnB,MAAM;4EACR;4EAEA,MAAM,IAAI,CAAC,IAAI,GAAG;4EAClB,2BAAK,GAAG,GAAG,EAAE;4EACb,MAAM,OAAO,GAAG;4EAChB,MAAM;4EACN,MAAM,IAAI,GAAG;4EACb,MAAM,MAAM;wEACd;oEACF;oEACA,WAAU;8EAEV,cAAA,gBAAC;;gEAIH,CAAA,AAAC,KAAK,SAAS,IAAI,CAAC,YACnB,CAAC,KAAK,SAAS,IAAI,2BAAK,GAAG,CAAC,MAAM,GAAG,CAAC,mBACvC,gBAAC;oEACC,SAAS,OAAO;wEACd,EAAE,eAAe;wEAEjB,IACE,QACE;4EAGF,IAAI,KAAK,SAAS,EAAE;gFAClB,MAAM,IAAI,GAAG;gFACb,OAAO,2BAAK,MAAM,CAAC,KAAK,EAAE,CAAC;gFAC3B,MAAM,MAAM;gFACZ,GAAG,WAAW,CAAC,MAAM,CAAC;oFACpB,OAAO;wFAAE,IAAI,KAAK,EAAE;oFAAW;oFAC/B,MAAM;wFACJ,YAAY;oFACd;gFACF;4EACF,OAAO;gFACL,MAAM,OAAO,GAAG;gFAChB,MAAM,MAAM;gFACZ,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;oFACnB,OAAO;wFAAE,IAAI,KAAK,EAAE;oFAAW;oFAC/B,MAAM;wFACJ,YAAY;oFACd;gFACF;gFAEA,MAAM,IAAI,CAAC,IAAI,GAAG;gFAClB,2BAAK,GAAG,GAAG,EAAE;gFACb,MAAM,OAAO,GAAG;gFAChB,MAAM;gFACN,MAAM,IAAI,GAAG;gFACb,MAAM,MAAM;4EACd;;oEAEJ;oEACA,WAAU;8EAEV,cAAA,gBAAC;wEACC,OAAM;wEACN,OAAM;wEACN,QAAO;wEACP,MAAK;wEACL,SAAQ;kFAER,cAAA,gBAAC;4EACC,MAAK;4EACL,UAAS;4EACT,GAAE;4EACF,UAAS;;;;;;;;8DAQvB,gBAAC;oDAAI,WAAU;8DAAU,KAAK,IAAI,EAAE;;;;;;;;oBAQ/C,MAAM,IAAI,CAAC,IAAI,kBACd,gBAAC,CAAA,GAAA,eAAO;wBACN,SAAS;4BACP,MAAM,IAAI,CAAC,IAAI,GAAG;4BAClB,MAAM,MAAM;wBACd;wBACA,QAAQ,OAAO,KAAK;4BAClB,IAAI,OAAO;gCACT,EAAE,OAAO,CAAC,IAAI,GAAG;gCACjB,SAAS,IAAI,GAAG,CAAC,QAAQ,EAAE,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;4BAClD,OAAO;gCACL,MAAM,IAAI,CAAC,IAAI,GAAG;gCAClB,2BAAK,GAAG,GAAG,EAAE;gCACb,MAAM,OAAO,GAAG;gCAChB,MAAM;gCACN,MAAM,IAAI,GAAG;gCACb,MAAM,MAAM;4BACd;wBACF;wBACA,MAAM,MAAM,IAAI,CAAC,IAAI;;;;;;AAMjC;AAEA,MAAM,iCAAW,kBACf,gBAAC;QACC,OAAM;QACN,OAAM;QACN,QAAO;QACP,MAAK;QACL,SAAQ;kBAER,cAAA,gBAAC;YACC,MAAK;YACL,UAAS;YACT,GAAE;YACF,UAAS;;;AAKf,MAAM,8BAAQ,kBACZ,gBAAC;QACC,OAAM;QACN,OAAO;QACP,QAAQ;QACR,WAAW,GACT,GAAG,CAAC;;MAEJ,CAAC;QAEH,MAAK;QACL,SAAQ;kBAER,cAAA,gBAAC;YACC,MAAK;YACL,UAAS;YACT,GAAE;YACF,UAAS;;;AAKf,MAAM,oCAAc,kBAClB,gBAAC;QACC,MAAK;QACL,SAAQ;QACR,aAAa;QACb,OAAO;QACP,QAAQ;QACR,OAAM;QACN,eAAY;kBAEZ,cAAA,gBAAC;YAAK,GAAE;;;AAIZ,MAAM,mCAAa,kBACjB,iBAAC;QACC,MAAK;QACL,aAAa;QACb,OAAO;QACP,QAAQ;QACR,SAAQ;QACR,OAAM;QACN,eAAY;;0BAEZ,gBAAC;gBACC,UAAS;gBACT,UAAS;gBACT,GAAE;;0BAEJ,gBAAC;gBAAK,GAAE;;;;AAIZ,MAAM,iCAAW,kBACf,gBAAC;QACC,OAAO;QACP,QAAQ;QACR,SAAQ;QACR,MAAK;QACL,OAAM;kBAEN,cAAA,gBAAC;YACC,GAAE;YACF,MAAK;YACL,UAAS;YACT,UAAS;;;;;;;;;;;;;;;;;;AC5rBR,MAAM,4CAIR,CAAC,QAAE,IAAI,WAAE,OAAO,UAAE,MAAM,EAAE;IAC7B,MAAM,IAAI,CAAA,GAAA,gBAAQ,EAAE,CAAA,GAAA,mBAAW,GAAG;IAClC,MAAM,QAAQ,CAAA,GAAA,eAAO,EAAE;QACrB,MAAM;QACN,QAAQ;QACR,SAAS;QACT,cAAc;IAChB;IACA,MAAM,OAAO,CAAA,GAAA,eAAO,EAAE,CAAC;IAEvB,IAAI,CAAC,MAAM,IAAI,EAAE;QACf,MAAM,IAAI,GAAG;QACb,KAAK,MAAM,CAAC,GAAG,EAAE,IAAI,OAAO,OAAO,CAAC,MAClC,AAAC,IAAY,CAAC,EAAE,GAAG;IAEvB;IAEA,qBACE;kBACE,cAAA,gBAAC;YACC,WAAU;YAEV,aAAa;gBACX,IAAI,CAAC,MAAM,YAAY,EACrB;gBAEF,MAAM,YAAY,GAAG;gBACrB,MAAM,MAAM;YACd;sBAEA,cAAA,iBAAC;gBACC,eAAe,CAAC;oBACd,EAAE,eAAe;oBACjB,MAAM,YAAY,GAAG;oBACrB,MAAM,MAAM;gBACd;gBACA,aAAa,CAAC;oBACZ,EAAE,eAAe;oBACjB,MAAM,YAAY,GAAG;oBACrB,MAAM,MAAM;gBACd;gBACA,UAAU,OAAO;oBACf,EAAE,cAAc;oBAChB,IAAI,KAAK,IAAI,IAAI,EAAE,OAAO,EAAE;wBAC1B,IAAI,CAAC,KAAK,IAAI,CAAC,UAAU,CAAC,YACxB,KAAK,iBAAiB,GAAG;wBAG3B,MAAM,MAAM,GAAG;wBACf,MAAM,MAAM;wBACZ,IAAI,YAAY,KAAK,SAAS;wBAC9B,IAAI,CAAC,aAAa,cAAc,QAAQ,YAAY;wBACpD,IAAI,CAAC,KAAK,EAAE,EAAE;4BACZ,MAAM,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gCAC/B,MAAM;oCACJ,cAAc;wCACZ,QAAQ,EAAE;wCACV,IAAI;wCACJ,MAAM;oCACR;oCACA,MAAM,KAAK,IAAI;oCACf,KAAK,KAAK,GAAG,IAAI;oCACjB,SAAS,KAAK,OAAO,IAAI;+CACzB;gCACF;4BACF;4BACA,OAAO,KAAK;wBACd,OAAO;4BACL,MAAM,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gCAC/B,MAAM;oCACJ,MAAM,KAAK,IAAI;oCACf,KAAK,KAAK,GAAG,IAAI;oCACjB,mBAAmB,KAAK,iBAAiB;gCAC3C;gCACA,OAAO;oCAAE,IAAI,KAAK,EAAE;gCAAC;4BACvB;4BACA,IAAI,EAAE,KAAK,IAAI,EAAE,IAAI,IAAI,EAAE,IAAI,CAAC,EAAE,KAAK,KAAK,EAAE,EAC5C,EAAE,KAAK,CAAC,QAAQ,CAAC;gCACf,IAAI,EAAE,KAAK,EAAE;oCACX,MAAM,OAAO,EAAE,KAAK,CAAC,MAAM,CAAC;oCAC5B,IAAI,MAAM;wCACP,KAAa,GAAG,CAAC,QAAQ,KAAK,IAAI;wCAClC,KAAa,GAAG,CAAC,OAAO,KAAK,GAAG;oCACnC;oCACA,OAAO,KAAK,MAAM,IAAI;gCACxB;4BACF;iCAEA,OAAO,KAAK;wBAEhB;wBAEA,MAAM,MAAM,GAAG;wBACf,MAAM,MAAM;oBACd;gBACF;gBACA,SAAS,CAAC;oBACR,EAAE,eAAe;gBACnB;gBACA,WAAW,GAAG,CAAA,GAAA,gBAAQ,GAAG;;kCAEzB,iBAAC;;0CACC,gBAAC;0CAAK;;0CACN,gBAAC,CAAA,GAAA,YAAI;gCACH,MAAM;gCACN,SAAS;gCACT,MAAM;gCACN,SAAS;oCACP,IAAI,CAAC,KAAK,GAAG,EAAE;wCACb,MAAM,OAAO,GAAG;wCAChB,MAAM,MAAM;oCACd;gCACF;gCACA,UAAU,CAAC;oCACT,IAAI,MAAM,OAAO,EACf,KAAK,GAAG,GAAG,CAAC,CAAC,EAAE,EAAE,OAAO,CAAC,OAAO,KAAK,OAAO,CAAC,UAAU,KAAK,CAAC;oCAE/D,KAAK,MAAM;gCACb;gCACA,QAAQ;oCACN,MAAM,OAAO,GAAG;oCAChB,MAAM,MAAM;gCACd;;;;oBAGH,KAAK,IAAI,EAAE,WAAW,2BACrB,iBAAC;;0CACC,gBAAC;0CAAK;;0CACN,iBAAC;gCAAI,WAAU;;kDACb,gBAAC;wCACC,WAAW,GACT,6DACA,KAAK,iBAAiB,IAAI;wCAE5B,SAAS;4CACP,KAAK,iBAAiB,GAAG;4CACzB,KAAK,MAAM;wCACb;kDACD;;kDAGD,gBAAC;wCACC,WAAW,GACT,6DACA,CAAC,KAAK,iBAAiB,IAAI;wCAE7B,SAAS;4CACP,KAAK,iBAAiB,GAAG;4CACzB,KAAK,MAAM;wCACb;kDACD;;;;;uCAML,iBAAC;;0CACC,gBAAC;0CAAK;;0CACN,gBAAC,CAAA,GAAA,YAAI;gCAAE,MAAM;gCAAM,MAAM;;;;oBAI5B,KAAK,EAAE,kBACN,iBAAC;;0CACC,gBAAC;0CAAK;;0CACN,gBAAC,CAAA,GAAA,YAAI;gCAAE,MAAM;gCAAM,MAAK;gCAAK,QAAQ;;;;kCAIzC,iBAAC;wBAAI,WAAU;;0CACb,gBAAC;gCAAO,MAAK;gCAAS,UAAU,MAAM,MAAM;gCAAE,WAAU;0CACrD,MAAM,MAAM,GAAG,cAAc;;4BAE/B,KAAK,EAAE,kBACN,gBAAC;gCACC,WAAU;gCACV,SAAS;oCACP,IAAI,QAAQ,mBAAmB;wCAC7B,MAAM,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;4CAC/B,OAAO;gDACL,IAAI,KAAK,EAAE;4CACb;4CACA,MAAM;gDACJ,YAAY;4CACd;wCACF;wCACA,OAAO,KAAK;oCACd;gCACF;0CAEA,cAAA,gBAAC;oCACC,OAAM;oCACN,OAAM;oCACN,QAAO;oCACP,MAAK;oCACL,SAAQ;8CAER,cAAA,gBAAC;wCACC,MAAK;wCACL,UAAS;wCACT,GAAE;wCACF,UAAS;;;;;;;;;;AAU7B;AAEA,MAAM,gCAAU,CAAC,GAAG;IAClB,MAAM,QAAQ,KAAK,IAAI,CAAC;IAExB,OAAO,MACJ,SAAS,CAAC,OAAO,4DAA4D;KAC7E,OAAO,CAAC,oBAAoB,IAAI,sCAAsC;KACtE,WAAW,GACX,IAAI,GACJ,OAAO,CAAC,eAAe,IAAI,oEAAoE;KAC/F,OAAO,CAAC,QAAQ,MAAM,YAAY;AACvC;;;;;;AC1OO,MAAM,4CAAY,GAAG,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+C7B,CAAC;;;;;;;;;AC7CM,MAAM,4CAST,CAAC;IACH,MAAM,OAAY;QAAE,GAAG,GAAG;IAAC;IAC3B,MAAM,QAAE,IAAI,QAAE,IAAI,EAAE,GAAG;IACvB,OAAO,KAAK,IAAI;IAChB,OAAO,KAAK,IAAI;IAEhB,IAAI,WAA8C;IAClD,IAAI,KAAK,QAAQ,EAAE;QACjB,WAAW,KAAK,QAAQ;QACxB,OAAO,KAAK,QAAQ;IACtB;IAEA,qBACE,gBAAC;QACC,OAAO,IAAI,CAAC,KAAK,IAAI;QACrB,YAAY;QACZ,SAAS,CAAC;YACR,IAAI,CAAC,KAAK,GAAG,EAAE,aAAa,CAAC,KAAK;YAElC,IAAI,UAAU;gBACZ,MAAM,SAAS,SAAS,EAAE,aAAa,CAAC,KAAK;gBAC7C,IAAI,OAAO,WAAW,aACpB,IAAI,CAAC,KAAK,GAAG;YAEjB;YAEA,KAAK,MAAM;QACb;QACC,GAAG,IAAI;;AAGd","sources":["src/render/editor/panel/manager/page/page-mgr.tsx","src/render/editor/panel/manager/page/page-mgr-form.tsx","src/utils/ui/form.style.ts","src/utils/ui/form/input.tsx"],"sourcesContent":["import {\n  DndProvider,\n  MultiBackend,\n  NodeModel,\n  Tree,\n  getBackendOptions,\n} from \"@minoru/react-dnd-treeview\";\nimport { page, page_folder } from \"dbgen\";\nimport { useEffect } from \"react\";\nimport { useGlobal, useLocal } from \"web-utils\";\nimport { Loading } from \"../../../../../utils/ui/loading\";\nimport { EditorGlobal } from \"../../../logic/global\";\nimport { PageForm } from \"./page-mgr-form\";\n\nexport type PageItem = {\n  id: string;\n  name: string;\n  url: string;\n  id_site: string;\n  id_folder: null | string;\n};\n\nconst data = {\n  all: [] as PageItem[],\n  folder: {} as Record<string, page_folder>,\n  pages: [] as NodeModel<PageItem>[],\n};\n\nconst w = window as unknown as {\n  pageManagerSearch: string;\n};\n\nexport const PageManager = () => {\n  const p = useGlobal(EditorGlobal, \"EDITOR\");\n  const local = useLocal({\n    page: {\n      folder_id: \"\",\n      data: null as Partial<page> | null,\n    },\n    editPageID: \"\",\n    editFolderID: \"\",\n    loading: false,\n    newFolder: { parentID: \"\", name: \"\" },\n    searchRef: null as any,\n    init: false,\n    scrollRef: null as null | HTMLDivElement,\n    initScrolled: false,\n  });\n\n  useEffect(() => {\n    const f = (e: any) => {\n      if (\n        e.key === \"Escape\" &&\n        document.activeElement?.tagName.toLowerCase() === \"input\"\n      ) {\n        w.pageManagerSearch = \"\";\n        local.render();\n      }\n      if (\n        local.searchRef &&\n        !local.page.data &&\n        document.activeElement?.tagName.toLowerCase() !== \"input\"\n      ) {\n        w.pageManagerSearch = \"\";\n        local.render();\n        local.searchRef.focus();\n      }\n    };\n    window.addEventListener(\"keydown\", f);\n    return () => {\n      window.removeEventListener(\"keydown\", f);\n    };\n  }, []);\n\n  const reloadPages = async () => {\n    if (local.loading) return true;\n    local.loading = true;\n    local.render();\n\n    const folders = await db.page_folder.findMany({\n      where: {\n        id_site: p.site.id,\n        is_deleted: false,\n      },\n    });\n    if (folders) {\n      data.folder = {};\n\n      for (const f of folders) {\n        data.folder[f.id] = { ...f };\n      }\n\n      data.all = await db.page.findMany({\n        where: {\n          id_site: p.site.id,\n          is_deleted: false,\n        },\n        select: {\n          id: true,\n          name: true,\n          url: true,\n          id_site: true,\n          is_default_layout: true,\n          id_folder: true,\n        },\n      });\n    }\n    local.loading = false;\n    local.render();\n  };\n  if (!Array.isArray(data.all)) {\n    data.all = [];\n  }\n\n  if (data.all.length === 0) {\n    reloadPages();\n  }\n\n  if (!local.init && !local.loading) {\n    data.pages = [\n      {\n        id: \"ROOT\",\n        parent: \"\",\n        text: \"Pages\",\n        droppable: true,\n      },\n    ];\n    const folders = new Set<string>();\n\n    for (const page of data.all) {\n      const fid = page.id_folder || \"-\";\n      const folder = data.folder[fid];\n\n      if (\n        w.pageManagerSearch &&\n        !(page.name + page.url)\n          .toLowerCase()\n          .includes(w.pageManagerSearch.toLowerCase())\n      ) {\n        continue;\n      }\n\n      let parent = folder?.id || \"ROOT\";\n      if (w.pageManagerSearch) parent = \"ROOT\";\n\n      data.pages.push({\n        id: page.id,\n        parent,\n        text: page.name,\n        data: { content: {}, ...page } as any,\n        droppable: false,\n      });\n    }\n\n    if (!w.pageManagerSearch) {\n      for (const folder of Object.values(data.folder)) {\n        if (!folders.has(folder.id)) {\n          folders.add(folder.id);\n          data.pages.push({\n            id: folder.id,\n            parent: folder.parent_id || \"ROOT\",\n            text: folder.name || \"\",\n            data: { content: {} } as any,\n            droppable: true,\n          });\n        }\n      }\n    }\n\n    if (local.newFolder.parentID) {\n      data.pages.push({\n        id: \"F-NEW-FOLDER\",\n        parent: local.newFolder.parentID,\n        text: \"\",\n        droppable: true,\n      });\n    }\n  }\n\n  const rawexpanded = localStorage.getItem(\"prasi-page-expand\");\n  let expanded = [\"ROOT\"];\n  if (rawexpanded) {\n    expanded = JSON.parse(rawexpanded);\n  }\n\n  return (\n    <>\n      <div\n        className=\"fixed  inset-0 bg-black bg-opacity-10 cursor-pointer\"\n        onClick={() => {\n          p.manager.page = false;\n          p.render();\n        }}\n      ></div>\n      <div className=\"fixed inset-[50px] bg-white shadow-2xl\">\n        {local.loading ? (\n          <div className=\"flex w-full h-full items-center justify-center\">\n            <Loading note=\"page-mgr\" backdrop={false} />\n          </div>\n        ) : (\n          <div\n            ref={(el) => {\n              local.scrollRef = el;\n            }}\n            className={cx(\n              \"relative w-full h-full flex items-stretch\",\n              css`\n                contain: content;\n                overflow: auto;\n\n                > ul {\n                  width: 100%;\n                  contain: content;\n                  overflow: auto;\n                }\n\n                .row {\n                  display: flex;\n                  flex-direction: column;\n                  align-items: stretch;\n                }\n\n                .dropping {\n                  background: #efefff;\n                }\n              `\n            )}\n          >\n            <div className=\"fixed top-0 right-[20px] bg-white z-10 m-[8px]\">\n              <input\n                type=\"search\"\n                value={w.pageManagerSearch || \"\"}\n                onChange={(e) => {\n                  w.pageManagerSearch = e.currentTarget.value;\n                  local.render();\n                }}\n                ref={(el) => {\n                  local.searchRef = el;\n                }}\n                placeholder=\"Search\"\n                className=\"border  px-2 text-sm h-[26px] outline-none w-[150px] focus:border-blue-500 focus:w-[350px] transition-all\"\n              />\n            </div>\n            <DndProvider backend={MultiBackend} options={getBackendOptions()}>\n              <Tree\n                tree={data.pages}\n                dragPreviewRender={() => <></>}\n                rootId=\"\"\n                onDrop={async (newTree: NodeModel<PageItem>[], opt) => {\n                  local.init = true;\n                  data.pages = newTree;\n                  local.render();\n\n                  if (!opt.dragSource?.droppable) {\n                    await db.page.update({\n                      where: {\n                        id: opt.dragSourceId as string,\n                      },\n                      data: {\n                        id_folder: (opt.dropTargetId === \"ROOT\" ||\n                        !opt.dropTargetId\n                          ? null\n                          : opt.dropTargetId) as string,\n                      },\n                      select: { id: true },\n                    });\n                  } else {\n                    await db.page_folder.update({\n                      where: {\n                        id: opt.dragSourceId as string,\n                      },\n                      data: {\n                        parent_id: (opt.dropTargetId === \"ROOT\" ||\n                        !opt.dropTargetId\n                          ? null\n                          : opt.dropTargetId) as string,\n                      },\n                      select: {\n                        id: true,\n                      },\n                    });\n                  }\n                  reloadPages();\n                }}\n                initialOpen={expanded}\n                classes={{\n                  listItem: \"row\",\n                  dropTarget: \"dropping\",\n                }}\n                onChangeOpen={(ids) => {\n                  localStorage.setItem(\n                    \"prasi-page-expand\",\n                    JSON.stringify(ids)\n                  );\n                }}\n                render={(node, { depth, isOpen, onToggle, hasChild }) => (\n                  <div\n                    ref={(el) => {\n                      if (\n                        el &&\n                        !local.initScrolled &&\n                        params.page_id === node.data?.id\n                      ) {\n                        local.initScrolled = true;\n                        el.scrollIntoView({\n                          behavior: \"instant\",\n                          block: \"center\",\n                        });\n                      }\n                    }}\n                    className={cx(\n                      \"flex items-center text-[14px] h-[30px] border-b border-l\",\n                      \"hover:bg-blue-50 cursor-pointer transition-all\",\n                      params.page_id === node.data?.id &&\n                        \" active border-l-4 border-l-blue-600 bg-blue-100\",\n                      css`\n                        .btn {\n                          display: none;\n                        }\n\n                        &:hover .btn {\n                          display: flex;\n                        }\n                      `\n                    )}\n                    style={{ marginInlineStart: depth * 10 }}\n                    onClick={() => {\n                      if (node.droppable) {\n                        onToggle();\n                      } else {\n                        const page = node.data;\n                        if (page && page.id) {\n                          p.manager.page = false;\n                          navigate(`/editor/${page.id_site}/${page.id}`);\n                        }\n                      }\n                    }}\n                  >\n                    <div className=\"w-[20px] flex items-center justify-center\">\n                      {node.droppable && (\n                        <>\n                          {isOpen && <FolderOpen />}\n                          {!isOpen && <FolderClose />}\n                        </>\n                      )}\n                      {!node.droppable && <Elbow />}\n                    </div>\n                    {local.editFolderID === node.id ? (\n                      <input\n                        type=\"text\"\n                        value={local.newFolder.name || \"\"}\n                        autoFocus\n                        onClick={(e) => {\n                          e.stopPropagation();\n                        }}\n                        className=\"text-sm flex-1 self-stretch my-[3px] px-2\"\n                        onBlur={async () => {\n                          local.editFolderID = \"\";\n                          if (local.newFolder.parentID) {\n                            if (local.newFolder.name) {\n                              const firstPage = data.all[0];\n\n                              local.loading = true;\n                              local.render();\n                              await db.page_folder.create({\n                                data: {\n                                  id_site: firstPage.id_site,\n                                  name: local.newFolder.name,\n                                  parent_id:\n                                    local.newFolder.parentID === \"ROOT\" ||\n                                    !local.newFolder.parentID\n                                      ? null\n                                      : local.newFolder.parentID,\n                                },\n                              });\n\n                              local.loading = false;\n                              await reloadPages();\n                              local.loading = false;\n                              local.init = false;\n                              local.render();\n                            }\n                          } else {\n                            node.text = local.newFolder.name;\n                            local.loading = true;\n                            local.render();\n                            await db.page_folder.update({\n                              data: {\n                                name: local.newFolder.name,\n                              },\n                              where: {\n                                id: node.id as string,\n                              },\n                              select: { id: true },\n                            });\n                            local.loading = false;\n                            await reloadPages();\n                            local.init = false;\n                            local.render();\n                          }\n\n                          local.newFolder.name = \"\";\n                          local.newFolder.parentID = \"\";\n                          local.render();\n                        }}\n                        onFocus={(e) => {\n                          e.currentTarget.select();\n                        }}\n                        onKeyDown={(e) => {\n                          if (e.key === \"Enter\") e.currentTarget.blur();\n                        }}\n                        onChange={(e) => {\n                          local.newFolder.name = e.currentTarget.value;\n                          local.render();\n                        }}\n                      />\n                    ) : (\n                      <div className=\"flex-1 flex items-stretch\">\n                        <div className=\"pr-5 flex items-center\">\n                          {node.text.startsWith(\"layout:\") ? (\n                            <>\n                              <div className=\"bg-green-700 text-white text-[10px] px-2 mr-1\">\n                                LAYOUT\n                              </div>\n                              <div>{node.text.substring(7)}</div>\n                            </>\n                          ) : (\n                            node.text\n                          )}\n                        </div>\n                        <div\n                          className={cx(\n                            \"flex flex-1 items-stretch space-x-1 pr-[20px] justify-end\"\n                          )}\n                        >\n                          {node.id !== \"ROOT\" && (\n                            <div\n                              onClick={(e) => {\n                                e.stopPropagation();\n\n                                if (node.droppable) {\n                                  local.init = false;\n                                  local.editFolderID = node.id as string;\n                                  local.render();\n                                } else {\n                                  local.page.data = node.data as any;\n                                  local.render();\n                                }\n                              }}\n                              className=\"btn w-[25px] border rounded-sm flex justify-center items-center text-slate-500 hover:text-blue-700 hover:border-blue-600 bg-white\"\n                            >\n                              <EditIcon />\n                            </div>\n                          )}\n                          {node.droppable && (\n                            <>\n                              <div\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  if (!isOpen) {\n                                    onToggle();\n                                  }\n\n                                  local.init = false;\n                                  local.editFolderID = \"F-NEW-FOLDER\";\n                                  local.newFolder.parentID = node.id as string;\n                                  local.render();\n                                }}\n                                className=\"btn px-2 text-xs border rounded-sm flex justify-center items-center text-slate-500 hover:text-blue-700 hover:border-blue-600 bg-white\"\n                              >\n                                <span> + Folder</span>\n                              </div>\n\n                              <div\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  if (!isOpen) {\n                                    onToggle();\n                                  }\n\n                                  local.init = false;\n                                  local.page.data = {\n                                    id_site: p.site.id,\n                                    id_folder: node.id as string,\n                                  };\n                                  local.page.folder_id = node.id as string;\n                                  local.render();\n                                }}\n                                className=\"btn px-2 text-xs border rounded-sm flex justify-center items-center text-slate-500 hover:text-blue-700 hover:border-blue-600 bg-white\"\n                              >\n                                <span> + Page</span>\n                              </div>\n                            </>\n                          )}\n\n                          {!node.droppable && (\n                            <div\n                              onClick={async (e) => {\n                                e.stopPropagation();\n                                if (confirm(\"Clone page ?\")) {\n                                  local.loading = true;\n                                  local.render();\n                                  const page = (await db.page.findFirst({\n                                    where: { id: node.id as string },\n                                  })) as any;\n\n                                  delete page.id;\n                                  page.name = `${page.name} [Cloned]`;\n                                  page.url = `${page.url}-cloned`;\n                                  await db.page.create({\n                                    data: page,\n                                  });\n\n                                  local.page.data = null;\n                                  data.all = [];\n                                  local.loading = false;\n                                  await reloadPages();\n                                  local.init = false;\n                                  local.render();\n                                }\n                              }}\n                              className=\"btn w-[25px] text-xs border rounded-sm flex justify-center items-center text-slate-500 hover:text-blue-700 hover:border-blue-600 bg-white\"\n                            >\n                              <CopyIcon />\n                            </div>\n                          )}\n\n                          {((node.droppable && !hasChild) ||\n                            (!node.droppable && data.all.length > 1)) && (\n                            <div\n                              onClick={async (e) => {\n                                e.stopPropagation();\n\n                                if (\n                                  confirm(\n                                    \"Deletting cannot be undone. Are you sure ?\"\n                                  )\n                                ) {\n                                  if (node.droppable) {\n                                    local.init = false;\n                                    delete data.folder[node.id];\n                                    local.render();\n                                    db.page_folder.update({\n                                      where: { id: node.id as string },\n                                      data: {\n                                        is_deleted: true,\n                                      },\n                                    });\n                                  } else {\n                                    local.loading = true;\n                                    local.render();\n                                    await db.page.update({\n                                      where: { id: node.id as string },\n                                      data: {\n                                        is_deleted: true,\n                                      },\n                                    });\n\n                                    local.page.data = null;\n                                    data.all = [];\n                                    local.loading = false;\n                                    await reloadPages();\n                                    local.init = false;\n                                    local.render();\n                                  }\n                                }\n                              }}\n                              className=\"btn w-[25px] text-xs border rounded-sm flex justify-center items-center text-slate-500 hover:text-blue-700 hover:border-blue-600 bg-white\"\n                            >\n                              <svg\n                                xmlns=\"http://www.w3.org/2000/svg\"\n                                width=\"15\"\n                                height=\"15\"\n                                fill=\"none\"\n                                viewBox=\"0 0 15 15\"\n                              >\n                                <path\n                                  fill=\"currentColor\"\n                                  fillRule=\"evenodd\"\n                                  d=\"M5.5 1a.5.5 0 000 1h4a.5.5 0 000-1h-4zM3 3.5a.5.5 0 01.5-.5h8a.5.5 0 010 1H11v8a1 1 0 01-1 1H5a1 1 0 01-1-1V4h-.5a.5.5 0 01-.5-.5zM5 4h5v8H5V4z\"\n                                  clipRule=\"evenodd\"\n                                ></path>\n                              </svg>\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    )}\n                    <div className=\"flex-1\">{node.data?.url}</div>\n                  </div>\n                )}\n              />\n            </DndProvider>\n          </div>\n        )}\n\n        {local.page.data && (\n          <PageForm\n            onClose={() => {\n              local.page.data = null;\n              local.render();\n            }}\n            onSave={async (res, isNew) => {\n              if (isNew) {\n                p.manager.page = false;\n                location.href = `/editor/${p.site.id}/${res.id}`;\n              } else {\n                local.page.data = null;\n                data.all = [];\n                local.loading = false;\n                await reloadPages();\n                local.init = false;\n                local.render();\n              }\n            }}\n            page={local.page.data}\n          />\n        )}\n      </div>\n    </>\n  );\n};\n\nconst EditIcon = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width=\"12\"\n    height=\"12\"\n    fill=\"none\"\n    viewBox=\"0 0 15 15\"\n  >\n    <path\n      fill=\"currentColor\"\n      fillRule=\"evenodd\"\n      d=\"M12.146 1.146a.5.5 0 01.707 0l2 2a.5.5 0 010 .708l-3.942 3.942a1 1 0 01-.26.188L6.724 9.947a.5.5 0 01-.671-.67l1.963-3.928a1 1 0 01.188-.26l3.942-3.943zm.354 1.061l-3.59 3.59-1.037 2.076.254.254 2.077-1.038L13.793 3.5 12.5 2.207zM10 2L9 3H4.9c-.428 0-.72 0-.944.019-.22.018-.332.05-.41.09a1 1 0 00-.437.437c-.04.078-.072.19-.09.41C3 4.18 3 4.472 3 4.9v6.2c0 .428 0 .72.019.944.018.22.05.332.09.41a1 1 0 00.437.437c.078.04.19.072.41.09.225.019.516.019.944.019h6.2c.428 0 .72 0 .944-.019.22-.018.332-.05.41-.09a1 1 0 00.437-.437c.04-.078.072-.19.09-.41.019-.225.019-.516.019-.944V7l1-1V11.12c0 .403 0 .735-.022 1.006-.023.281-.072.54-.196.782a2 2 0 01-.874.874c-.243.124-.501.173-.782.196-.27.022-.603.022-1.005.022H4.88c-.403 0-.735 0-1.006-.022-.281-.023-.54-.072-.782-.196a2 2 0 01-.874-.874c-.124-.243-.173-.501-.196-.782C2 11.856 2 11.523 2 11.12V4.88c0-.403 0-.735.022-1.006.023-.281.072-.54.196-.782a2 2 0 01.874-.874c.243-.124.501-.173.782-.196C4.144 2 4.477 2 4.88 2H10z\"\n      clipRule=\"evenodd\"\n    ></path>\n  </svg>\n);\n\nconst Elbow = () => (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    width={10}\n    height={10}\n    className={cx(\n      css`\n        opacity: 0.3;\n      `\n    )}\n    fill=\"none\"\n    viewBox=\"0 0 15 15\"\n  >\n    <path\n      fill=\"currentColor\"\n      fillRule=\"evenodd\"\n      d=\"M9.877 12H11.5a.5.5 0 000-1H9.9c-1.128 0-1.945 0-2.586-.053-.637-.052-1.057-.152-1.403-.329a3.5 3.5 0 01-1.53-1.529c-.176-.346-.276-.766-.328-1.403C4 7.045 4 6.228 4 5.1V3.5a.5.5 0 00-1 0v1.623c0 1.1 0 1.958.056 2.645.057.698.175 1.265.434 1.775a4.5 4.5 0 001.967 1.966c.51.26 1.077.378 1.775.435C7.92 12 8.776 12 9.877 12z\"\n      clipRule=\"evenodd\"\n    ></path>\n  </svg>\n);\n\nconst FolderClose = () => (\n  <svg\n    fill=\"currentColor\"\n    viewBox=\"0 0 20 20\"\n    strokeWidth={1}\n    width={13}\n    height={13}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    aria-hidden=\"true\"\n  >\n    <path d=\"M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z\" />\n  </svg>\n);\n\nconst FolderOpen = () => (\n  <svg\n    fill=\"currentColor\"\n    strokeWidth={1}\n    width={13}\n    height={13}\n    viewBox=\"0 0 20 20\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    aria-hidden=\"true\"\n  >\n    <path\n      clipRule=\"evenodd\"\n      fillRule=\"evenodd\"\n      d=\"M2 6a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1H8a3 3 0 00-3 3v1.5a1.5 1.5 0 01-3 0V6z\"\n    />\n    <path d=\"M6 12a2 2 0 012-2h8a2 2 0 012 2v2a2 2 0 01-2 2H2h2a2 2 0 002-2v-2z\" />\n  </svg>\n);\n\nconst CopyIcon = () => (\n  <svg\n    width={15}\n    height={15}\n    viewBox=\"0 0 15 15\"\n    fill=\"none\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <path\n      d=\"M1 9.50006C1 10.3285 1.67157 11.0001 2.5 11.0001H4L4 10.0001H2.5C2.22386 10.0001 2 9.7762 2 9.50006L2 2.50006C2 2.22392 2.22386 2.00006 2.5 2.00006L9.5 2.00006C9.77614 2.00006 10 2.22392 10 2.50006V4.00002H5.5C4.67158 4.00002 4 4.67159 4 5.50002V12.5C4 13.3284 4.67158 14 5.5 14H12.5C13.3284 14 14 13.3284 14 12.5V5.50002C14 4.67159 13.3284 4.00002 12.5 4.00002H11V2.50006C11 1.67163 10.3284 1.00006 9.5 1.00006H2.5C1.67157 1.00006 1 1.67163 1 2.50006V9.50006ZM5 5.50002C5 5.22388 5.22386 5.00002 5.5 5.00002H12.5C12.7761 5.00002 13 5.22388 13 5.50002V12.5C13 12.7762 12.7761 13 12.5 13H5.5C5.22386 13 5 12.7762 5 12.5V5.50002Z\"\n      fill=\"currentColor\"\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n    ></path>\n  </svg>\n);\n","import { page } from \"dbgen\";\nimport { FC } from \"react\";\nimport { useGlobal, useLocal } from \"web-utils\";\nimport { EditorGlobal } from \"../../../logic/global\";\nimport { formStyle } from \"../../../../../utils/ui/form.style\";\nimport { Input } from \"../../../../../utils/ui/form/input\";\n\nexport const PageForm: FC<{\n  page: Partial<page>;\n  onClose: () => void;\n  onSave: (res: any, isNew: boolean) => void;\n}> = ({ page, onClose, onSave }) => {\n  const p = useGlobal(EditorGlobal, \"EDITOR\");\n  const local = useLocal({\n    init: false,\n    saving: false,\n    fillUrl: false,\n    preventClose: false,\n  });\n  const form = useLocal({} as Partial<page>);\n\n  if (!local.init) {\n    local.init = true;\n    for (const [k, v] of Object.entries(page)) {\n      (form as any)[k] = v;\n    }\n  }\n\n  return (\n    <>\n      <div\n        className=\"absolute cursor-pointer inset-0 flex items-center justify-center\n         backdrop-blur cursor-pointer hover:backdrop-blur-sm transition-all\"\n        onPointerUp={() => {\n          if (!local.preventClose) {\n            onClose();\n          }\n          local.preventClose = false;\n          local.render();\n        }}\n      >\n        <form\n          onPointerDown={(e) => {\n            e.stopPropagation();\n            local.preventClose = true;\n            local.render();\n          }}\n          onPointerUp={(e) => {\n            e.stopPropagation();\n            local.preventClose = false;\n            local.render();\n          }}\n          onSubmit={async (e) => {\n            e.preventDefault();\n            if (form.name && p.session) {\n              if (!form.name.startsWith(\"layout:\")) {\n                form.is_default_layout = false;\n              }\n\n              local.saving = true;\n              local.render();\n              let id_folder = form.id_folder;\n              if (!id_folder || id_folder === \"ROOT\") id_folder = null;\n              if (!form.id) {\n                const res = await db.page.create({\n                  data: {\n                    content_tree: {\n                      childs: [],\n                      id: \"root\",\n                      type: \"root\",\n                    },\n                    name: form.name,\n                    url: form.url || \"\",\n                    id_site: form.id_site || \"\",\n                    id_folder,\n                  },\n                });\n                onSave(res, true);\n              } else {\n                const res = await db.page.update({\n                  data: {\n                    name: form.name,\n                    url: form.url || \"\",\n                    is_default_layout: form.is_default_layout,\n                  },\n                  where: { id: form.id },\n                });\n                if (p.mpage && p.page && p.page.id === form.id) {\n                  p.mpage.transact(() => {\n                    if (p.mpage) {\n                      const page = p.mpage.getMap(\"map\");\n                      if (page) {\n                        (page as any).set(\"name\", form.name);\n                        (page as any).set(\"url\", form.url);\n                      }\n                      onSave(page.toJSON(), false);\n                    }\n                  });\n                } else {\n                  onSave(res, false);\n                }\n              }\n\n              local.saving = false;\n              local.render();\n            }\n          }}\n          onClick={(e) => {\n            e.stopPropagation();\n          }}\n          className={cx(formStyle, \"bg-white shadow-2xl border\")}\n        >\n          <label>\n            <span>Name</span>\n            <Input\n              form={form}\n              autoFocus\n              name={\"name\"}\n              onFocus={() => {\n                if (!form.url) {\n                  local.fillUrl = true;\n                  local.render();\n                }\n              }}\n              onChange={(e) => {\n                if (local.fillUrl) {\n                  form.url = `/${e.replace(/\\W/g, \"/\").replace(/\\/\\/+/g, \"/\")}`;\n                }\n                form.render();\n              }}\n              onBlur={() => {\n                local.fillUrl = false;\n                local.render();\n              }}\n            />\n          </label>\n          {form.name?.startsWith(\"layout:\") ? (\n            <label>\n              <span>Default Layout</span>\n              <div className=\"flex space-x-2\">\n                <div\n                  className={cx(\n                    \"border-[3px] px-4 cursor-pointer select-none border-black\",\n                    form.is_default_layout && \"bg-black text-white \"\n                  )}\n                  onClick={() => {\n                    form.is_default_layout = true;\n                    form.render();\n                  }}\n                >\n                  YES\n                </div>\n                <div\n                  className={cx(\n                    \"border-[3px] px-2 cursor-pointer select-none border-black\",\n                    !form.is_default_layout && \"bg-black text-white\"\n                  )}\n                  onClick={() => {\n                    form.is_default_layout = false;\n                    form.render();\n                  }}\n                >\n                  NO\n                </div>\n              </div>\n            </label>\n          ) : (\n            <label>\n              <span>url</span>\n              <Input form={form} name={\"url\"} />\n            </label>\n          )}\n\n          {form.id && (\n            <label>\n              <span>Page ID:</span>\n              <Input form={form} name=\"id\" disabled />\n            </label>\n          )}\n\n          <div className=\"flex\">\n            <button type=\"submit\" disabled={local.saving} className=\"flex-1\">\n              {local.saving ? \"Saving...\" : \"Save\"}\n            </button>\n            {form.id && (\n              <button\n                className=\"bg-red-600 w-[40px] flex justify-center items-center\"\n                onClick={async () => {\n                  if (confirm(\"Are you sure ?\")) {\n                    const res = await db.page.update({\n                      where: {\n                        id: page.id,\n                      },\n                      data: {\n                        is_deleted: true,\n                      },\n                    });\n                    onSave(res, false);\n                  }\n                }}\n              >\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"15\"\n                  height=\"15\"\n                  fill=\"none\"\n                  viewBox=\"0 0 15 15\"\n                >\n                  <path\n                    fill=\"currentColor\"\n                    fillRule=\"evenodd\"\n                    d=\"M5.5 1a.5.5 0 000 1h4a.5.5 0 000-1h-4zM3 3.5a.5.5 0 01.5-.5h8a.5.5 0 010 1H11v8a1 1 0 01-1 1H5a1 1 0 01-1-1V4h-.5a.5.5 0 01-.5-.5zM5 4h5v8H5V4z\"\n                    clipRule=\"evenodd\"\n                  ></path>\n                </svg>\n              </button>\n            )}\n          </div>\n        </form>\n      </div>\n    </>\n  );\n};\n\nconst slugify = (...args: string[]): string => {\n  const value = args.join(\" \");\n\n  return value\n    .normalize(\"NFD\") // split an accented letter in the base letter and the acent\n    .replace(/[\\u0300-\\u036f]/g, \"\") // remove all previously split accents\n    .toLowerCase()\n    .trim()\n    .replace(/[^a-z0-9 ]/g, \"\") // remove all chars not letters, numbers and spaces (to be replaced)\n    .replace(/\\s+/g, \"/\"); // separator\n};\n","export const formStyle = css`\n  padding: 10px;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n\n  .title {\n    font-size: 18px;\n    display: flex;\n    flex-direction: column;\n  }\n\n  label {\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n    margin-bottom: 10px;\n\n    > span {\n      font-size: 14px;\n      margin-bottom: 2px;\n    }\n  }\n  \n  input,\n  select {\n    border: 3px solid black;\n    padding: 3px;\n    width: 300px;\n    font-size: 15px;\n\n    &:disabled {\n      color: #999;\n    }\n  }\n\n  button {\n    color: white;\n    padding: 5px;\n  }\n  button[type=\"submit\"] {\n    background: black;\n\n    &:disabled {\n      background: #999;\n    }\n  }\n`;\n","import { FC } from \"react\";\n\nexport const Input: FC<\n  Omit<\n    React.InputHTMLAttributes<HTMLInputElement>,\n    \"form\" | \"name\" | \"onChange\"\n  > & {\n    form: Record<string, any> & { render: () => void };\n    name: string;\n    onChange?: (text: string) => string | void;\n  }\n> = (arg) => {\n  const prop: any = { ...arg };\n  const { form, name } = arg;\n  delete prop.form;\n  delete prop.name;\n\n  let onChange: ((text: string) => string) | null = null;\n  if (prop.onChange) {\n    onChange = prop.onChange;\n    delete prop.onChange;\n  }\n\n  return (\n    <input\n      value={form[name] || \"\"}\n      spellCheck={false}\n      onInput={(e) => {\n        form[name] = e.currentTarget.value;\n\n        if (onChange) {\n          const result = onChange(e.currentTarget.value);\n          if (typeof result !== \"undefined\") {\n            form[name] = result;\n          }\n        }\n\n        form.render();\n      }}\n      {...prop}\n    />\n  );\n};\n"],"names":[],"version":3,"file":"page-mgr.6c081154.js.map"}